<!DOCTYPE html> 
<html lang="en"> 
<head> 
    <title>Ofrenda 3D - D√≠a de Muertos</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            background: #241440;
            overflow: hidden;
        }
        canvas { 
            display: block; 
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <canvas id="myCanvas"></canvas>

    <!-- Three.js desde CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    
    <!-- Objetos convertidos -->
    <script>
        // =============================================
        // PAN.js - CONVERTIDO PARA CDN
        // =============================================
        function createPan(position = {x:0, y:0, z:0}) {
            const group = new THREE.Group();

            // PAN DE DIFUNTO
            var ggeometry02 = new THREE.SphereGeometry(3);
            var gmaterial02 = new THREE.MeshLambertMaterial({
                color:0xF5C276, side: THREE.DoubleSide
            });
            var gmesh02 = new THREE.Mesh(ggeometry02,gmaterial02);
            gmesh02.position.set(0,2.4,0);
            gmesh02.scale.set(1.4,.7,1.4);
            gmesh02.castShadow = true; 

            var ggeometry03 = new THREE.SphereGeometry(.5);
            var gmaterial03 = new THREE.MeshLambertMaterial({
                color:0x59300C, side: THREE.DoubleSide
            });
            var gmesh03 = new THREE.Mesh(ggeometry03,gmaterial03);
            gmesh03.position.set(0,4.3,2);
            gmesh03.scale.set(1.4,.8,2);
            gmesh03.rotation.set(.41,0,0);
            gmesh03.castShadow = true; 

            var gmesh04 = new THREE.Mesh(ggeometry03,gmaterial03);
            gmesh04.position.set(0,3.7,3.2);
            gmesh04.scale.set(1.5,.8,2);
            gmesh04.rotation.set(.7,0,0);
            gmesh04.castShadow = true; 

            var ghuesito1 = new THREE.Group();
            ghuesito1.add(gmesh03,gmesh04);
            ghuesito1.castShadow = true; 

            var ghuesito2 = ghuesito1.clone();
            ghuesito2.position.set(0,0,0);
            ghuesito2.rotation.set(0,1.57,0);
            ghuesito2.castShadow = true; 

            var ghuesito3 = ghuesito1.clone();
            ghuesito3.position.set(0,0,0);
            ghuesito3.rotation.set(0,3.14,0);
            ghuesito3.castShadow = true; 

            var ghuesito4 = ghuesito1.clone();
            ghuesito4.position.set(0,0,0);
            ghuesito4.rotation.set(0,4.71,0);
            ghuesito4.castShadow = true; 

            //huesitos peque√±os 
            var ghuesito5 = ghuesito1.clone();
            ghuesito5.scale.set(.6,.7,.7)
            ghuesito5.position.set(0,1.5,0);
            ghuesito5.rotation.set(0,.785,0);
            ghuesito5.castShadow = true; 

            var ghuesito6 = ghuesito1.clone();
            ghuesito6.scale.set(.6,.7,.7)
            ghuesito6.position.set(0,1.5,0);
            ghuesito6.rotation.set(0,2.355,0);
            ghuesito6.castShadow = true; 

            var ghuesito7 = ghuesito1.clone();
            ghuesito7.scale.set(.6,.7,.7)
            ghuesito7.position.set(0,1.5,0);
            ghuesito7.rotation.set(0,3.925,0);
            ghuesito7.castShadow = true; 

            var ghuesito8 = ghuesito1.clone();
            ghuesito8.scale.set(.6,.7,.7)
            ghuesito8.position.set(0,1.5,0);
            ghuesito8.rotation.set(0,5.495,0);
            ghuesito8.castShadow = true; 

            var ggeometry04 = new THREE.SphereGeometry(1.5);
            var gmesh05 = new THREE.Mesh(ggeometry04,gmaterial03);
            gmesh05.position.set(0,4,0);
            gmesh05.castShadow = true; 

            group.add(gmesh02,ghuesito1,ghuesito2,ghuesito3,ghuesito4,ghuesito5,ghuesito6,ghuesito7,ghuesito8,gmesh05);
            group.position.set(position.x, position.y, position.z);

            return group;
        }
    </script>

    <!-- Script Principal -->
    <script>
        // üïπÔ∏è Renderer
        var renderer = new THREE.WebGLRenderer({
            canvas: document.getElementById('myCanvas'), 
            antialias: true
        });
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x241440);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;

        // üé¨ Escena
        var scene = new THREE.Scene();

        // üé• C√°mara
        var camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 2000);
        camera.position.set(0, 40, 300);
        scene.add(camera);

        // üéÆ Controles
        var controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;

        // üí° Luces
        var ambientLight = new THREE.AmbientLight(0x404040, 0.6);
        scene.add(ambientLight);

        var directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(50, 100, 50);
        directionalLight.castShadow = true;
        directionalLight.shadow.mapSize.width = 1024;
        directionalLight.shadow.mapSize.height = 1024;
        scene.add(directionalLight);

        // ‚úÖ Cubo de prueba (temporal)
        var geometry = new THREE.BoxGeometry(10, 10, 10);
        var material = new THREE.MeshLambertMaterial({ color: 0x00ff00 });
        var cube = new THREE.Mesh(geometry, material);
        cube.position.set(0, 0, 0);
        scene.add(cube);

        // üçû AGREGAR PAN
        const pan = createPan({x:-20, y:39, z:-30});
        scene.add(pan);

        // üé∞ Animaci√≥n
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        // üì± Manejar redimensionado
        window.addEventListener('resize', function() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // üîç Debug: Verificar que todo cargue
        console.log('Escena cargada correctamente');
        console.log('Objetos en escena:', scene.children.length);
    </script>
</body>
</html>
